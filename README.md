# CV数据分析GUI应用使用指南

## 功能概述

这是一个基于PySide6的图形用户界面应用程序，用于分析CHI660E电化学工作站的循环伏安（CV）测试数据。

## 主要功能

### 1. 文件导入
- 点击"导入CV数据文件"按钮
- 选择导出的txt格式数据文件
- 应用自动解析文件并提取CV实验数据

### 2. 循环结果展示
- 在左侧表格中显示每一轮循环（2个Segments）的：
  - 循环编号
  - 面积（单位：C，库伦）
  - 电容值（单位：mF，毫法）

### 3. 最终统计结果
- 显示实验参数（初始电压、最高/最低电压、扫描速率、灵敏度等）
- 显示最终统计结果：
  - 有效循环数
  - 被排除的离群值个数
  - 平均电容值
  - 最小值、最大值
  - 标准差
  - 变异系数

### 4. 数据绘图
- 在右侧绘制所有循环的V-I曲线
- 每个循环使用不同的颜色进行区分
- 使用Times New Roman字体，字号较大（14-16磅）
- 包含图例和网格线

### 5. 图表导出
- 可将绘制的图表导出为PNG格式（300 dpi）
- 可将绘制的图表导出为SVG矢量格式

## 运行方法

### 方式一：直接运行GUI
```bash
python cv_gui.py
```

### 方式二：使用启动脚本
```bash
python run_gui.py
```

## 依赖环境

- Python 3.13+
- PySide6 6.9.2+
- matplotlib 3.10.6+
- 核心分析模块：cv_analysis.py

## 文件结构

```
CVAnalysis/
├── cv_analysis.py          # 核心分析模块
├── cv_gui.py               # GUI应用主程序
├── run_gui.py              # 启动脚本
├── test_cv_data.txt        # 测试数据文件
└── README.md              # 本文件
```

## 使用示例

1. **启动应用**
   - 运行 `python cv_gui.py`
   - 应用窗口将打开

2. **导入数据**
   - 点击"导入CV数据文件"按钮
   - 选择你的CV数据txt文件

3. **查看结果**
   - 左侧表格自动显示每轮循环的电容值
   - 左下方文本区域显示最终统计结果
   - 右侧图表实时显示V-I曲线

4. **导出图表**
   - 点击"保存为PNG"保存为高清图片（300 dpi）
   - 点击"保存为SVG"保存为矢量图，便于后续编辑

## 关键参数说明

- **sensitivity_threshold_factor**: 电流超出多少倍灵敏度时发出警告（默认10倍）
- **outlier_count**: 排除最离群值时的个数（默认1个）
- 这两个参数可在CVAnalyzer类初始化时修改

## 注意事项

1. 确保导入的txt文件包含"Cyclic Voltammetry"字样
2. 数据应包含"Potential/V, Current/A"表头
3. 超出灵敏度范围的循环会被自动标记并排除
4. 使用Z-score方法排除最离群的电容值

## 技术架构

- **GUI框架**: PySide6
- **绘图库**: Matplotlib
- **数据处理**: 梯形积分法计算CV曲线面积
- **统计方法**: 使用标准差和Z-score进行离群值检测

---

版本: 1.0  
最后更新: 2025年1月28日
